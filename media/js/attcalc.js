"use strict";for(var chanelLog,cbHwnd,session="0",orgMsg="*",Dy=parent.dayjs,srpt=document.getElementsByTagName("script"),calcTerminate=!1,chanelDeffered=null,doDelay=function(e){e.origin.indexOf(chanelLog[1].addr)>0&&(chanelLog[1].origin=e.origin,cbHwnd&&"function"==typeof cbHwnd&&cbHwnd(e.data.evtData))},hwndMsg=function(e){void 0===e.data.messageType?"s3_tinhcong_hole"==e.data.evtData.evt&&(chanelLog?doDelay(e):chanelDeffered=[doDelay,e]):"0"==e.data.messageType?(calcTerminate=!1,new attTiCo(event.data)):"-9999"==e.data.messageType&&(calcTerminate=!0)},attTiCo=function(e){var a,t,n,s,o,i,g,d=[];a=0,t=e.runI,n=e.a,s=e.delay,o=e.loc,i=function(){var e;(e=s,new Promise(function(a){e>0?setTimeout(function(){a("result")},e):a("result")})).then(function(e){var s={id:t-a,acno:n.acno,ten:n.ten,ngay:new Date(new Date(n.aLogs[a]).setHours(0,0,0,0)),thu:n.aLogs[a].toLocaleString(o,{weekday:"short"}),fio1:n.aLogs[a],TongTG:2};d.push(s);for(var i=a+1;i<n.aLogs.length;i++){if(calcTerminate)return;if(Dy(n.aLogs[a]).format("YYYY-MM-DD")!=Dy(n.aLogs[i]).format("YYYY-MM-DD")){a=i-1;break}s["fio"+s.TongTG]=n.aLogs[i],s.TongTG++,a=i}window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:"0",data:{acno:n.acno,p:Math.round((a+1)/n.aLogs.length*100)}}},orgMsg),a++,g()})},(g=function(){calcTerminate||(a<n.aLogs.length?i():window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:1,data:d}},orgMsg))})()},i=0;i<srpt.length;i++){var dat=srpt[i].getAttribute("seson");dat&&(dat=atob(dat).split("|"),session=dat[0],orgMsg=dat[1])}window.parent.postMessage({msgtype:"session",msgkind:session,evtData:{messageType:0}},orgMsg),window.addEventListener?window.addEventListener("message",hwndMsg,!1):window.attachEvent&&window.attachEvent("onmessage",hwndMsg);