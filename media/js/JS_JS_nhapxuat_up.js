!function(){"use strict";Main._upl0d||(Main._upl0d=function(){function e(t,a){if(!(this instanceof e))return new e(t,a);var n,i=("draggable"in(n=document.createElement("div"))||"ondragstart"in n&&"ondrop"in n)&&"FormData"in window&&"FileReader"in window,s=t.querySelector(".drag-file-area"),o=(t.querySelector(".browse-files"),t.querySelector(".upload-icon")),l=t.querySelector(".dynamic-message"),r=t.querySelector(".default-file-input"),d=r.getAttribute("accept")||"",c=t.querySelector(".cannot-upload-message"),u=t.querySelector(".cancel-alert-button"),p=t.querySelector(".file-block"),f=t.querySelector(".file-name"),m=t.querySelector(".file-size"),_=t.querySelector(".progress-upload"),h=t.querySelector(".remove-file-icon"),g=t.querySelector(".upload-button:not(#test_msg)"),v=(t.querySelector(".form-container"),1),b=function(e,t){t||(t=r.files),0!=t.length&&(t[0].type.trim().length>0&&d.indexOf(t[0].type)>-1?(g.innerHTML=a.lan.uploadButton||"Upload",f.innerHTML=t[0].name,m.innerHTML=(t[0].size/1024).toFixed(1)+" KB",p.style.cssText="display: flex;",_.style.width=0,v=0,w.drop()):(w.normal(),c.querySelector(".cannot-text").innerHTML=a.lan.wrongfile||"Invalid file type !",c.style.cssText="display: flex; animation: fadeIn linear 1.5s;",v=1))},w={normal:function(){o.setAttribute("class","fa fa-cloud-upload upload-icon"),l.innerHTML=a.lan.dragDropText_normal||"Drag & drop file .xlsx here",s.parentNode.classList.remove("dropok"),g.innerHTML=a.lan.uploadButton||"Upload",c.style.cssText="display: none;",p.style.cssText="display: none;",r.value=""},dragin:function(){o.setAttribute("class","fa fa-clone upload-icon"),1==v&&(l.innerHTML=a.lan.dragDropText_dragin||"Drop your file here!")},drop:function(){s.parentNode.classList.add("dropok"),o.setAttribute("class","fa fa-check-circle upload-icon"),l.innerHTML=a.lan.dragDropText_drop||"File Dropped Successfully!";var e=l.nextElementSibling.children;e[0].innerHTML=a.lan.nhan||"drag & drop or",e[1].querySelector("span:last-child").innerHTML="",c.style.cssText="display: none;"}};r.addEventListener("click",function(){var e;if(11!=GetIEVersion()&&r.files.length>0){var t=r.files[0];e=new File([t],t.name,{type:t.type,lastModified:t.lastModified})}if(r.value="",11!=GetIEVersion()&&e){const t=new DataTransfer;t.items.add(e),r.files=t.files}}),r.addEventListener("change",b),g.addEventListener("click",function(){if(""!=r.value){const e=10485760;if(r.files[0].size>e)return void devDlg(0,"File size exceeds 10 MB.<br/>"+_La$N("js_007_11",aLAN)).show();a.upclk&&a.upclk(r.files[0],g,_,v),0==v&&(v=1)}else c.querySelector(".cannot-text").innerHTML=a.lan.selfirst||"Please select a file first !",c.style.cssText="display: flex; animation: fadeIn linear 1.5s;"}),g.previousElementSibling.addEventListener("click",function(){requestAnimationFrame(function(){$(t).closest("#tabBODY_JS_nhapxuat").find(".system_monitor").trigger("click")})}),u.addEventListener("click",function(){c.style.cssText="display: none;"}),s.addEventListener("click",function(e){r.click()}),i&&(["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(function(e){s.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()})}),["dragover","dragenter"].forEach(function(e){console.log("dragover ragenter"),s.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation(),w.dragin()})}),s.addEventListener("dragleave",function(e){1==v?w.normal():o.setAttribute("class","fa fa-check-circle upload-icon")}),s.addEventListener("drop",function(e){11!=GetIEVersion()&&(r.files=e.dataTransfer.files),b(null,e.dataTransfer.files)})),h.addEventListener("click",function(){p.style.cssText="display: none;",r.value="";var e=l.nextElementSibling.children;e[0].innerHTML="or",e[1].querySelector("span:last-child").innerHTML="from device",w.normal(),v=1})}function t(t){const a=["Basic salary","Meal allowance","Phone allowance","Fuel allowance","Toxic allowance","Longevity allowance","Responsibility payment"];var n,i,s,o=0,l=t._tabId,r=t.$mainO,d={lan:t.lan||{},fNUM:function(e){return e},fNGA:function(e){if(e&&(e=new Date(e))instanceof Date&&!isNaN(e))return e},fTXT:function(e,t,a){if(e)return a&&e.length>a?e.slice(0,a):e.trim()},fDEC:function(e){if(e&&!isNaN(e))return Number(e)},eMAIL:function(e,t,a){if(e){e=a&&e.length>a?e.slice(0,a):e.trim();return/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)?e:void 0}}},c=function(e){e.value&&($.isNumeric(e.value)||(e.value=e.previousValue||null),$.isNumeric(e.value)&&(e.value=parseInt(e.value)),e.component.option("value",e.value))},u=function(e,t,a){var n=["This data column must be <code style='font-size:120%'>numeric</code> and will be discarded if it is a <code style='font-size:120%'>duplicate</code>.","Will remove if <code style='font-size:120%'>duplicate</code> and maximum length  <code style='font-size:120%'>50 characters</code>."];$("<div>"+(_La$N("js_013_11|"+a,d.lan)||n[a])+"</div>").appendTo(t).dxPopover({target:e,showEvent:"mouseenter",hideEvent:"mouseleave",position:"top",width:300,animation:{show:{type:"pop",from:{scale:0},to:{scale:1}},hide:{type:"fade",from:1,to:0}}})},p=function(e){e.preventDefault(),e.stopPropagation();var t=admin$.popup({a:"d",fw:0}),a=t.find("#popupdone");t.find(".modal-dialog").addClass("modal-dialog-centered modal-dialog-zoom pu_fullW my-0").css({"max-width":"800px"});var n=t.find(".modal-body").addClass("pefectS_R"),i=function(){return n.append($(".test_help").clone().removeClass("d-none")),n[0]};a.remove(),t.one("shown.bs.modal",function(){new PerfectScrollbar(i(),{suppressScrollX:!0})}).one("hide.bs.modal",function(){}),setTimeout(function(){t.modal("show")},1)};const f=function(e){return o!=e&&(o=e,n=(d.__refW||app_container).innerWidth()),m(n)},m=function(e){return e<540?"xs":e<800?"sm":e<1200?"md":"lg"};var _,h,g,v,b,w,L={screenByWidth:f,labelMode:"floating",formData:{acno:"B",empcode:"C",ho:"D",ten:"E",secid:null,posid:null,hireday:null,offdate:null,birthday:null,gender:null,marital:null,degree:null,email:null,phone:null,cmnd:null,address:null,mo1:0,mo2:0,mo3:0,mo4:0,mo5:0,mo6:0,mo7:0,s_dongdulieu:3,e_dongdulieu:void 0},readOnly:!1,showColonAfterLabel:!0,labelLocation:"left",minColWidth:200,colCount:7,colCountByScreen:{xs:2,sm:4,md:5},visible:!1,items:[{dataField:"acno",label:{text:_La$N("js_007_1",aLAN)||"EmpID"},typ:d.fNUM},{dataField:"empcode",label:{text:_La$N("js_007_3",aLAN)||"EmpCode"},mLen:50},{dataField:"ho",label:{text:_La$N("js_007_5",aLAN)||"LastName"},mLen:150},{dataField:"ten",label:{text:_La$N("js_007_7",aLAN)||"FirstName"},mLen:150},{dataField:"gender",label:{text:_La$N("js_007_12",aLAN)||"Gender"}},{dataField:"birthday",label:{text:_La$N("js_007_9",aLAN)||"Bithday"},typ:d.fNGA},{dataField:"secid",label:{text:_La$N("js_007_14",aLAN)||"Organization"},mLen:200},{dataField:"posid",label:{text:_La$N("js_007_15",aLAN)||"Postion"},mLen:200},{dataField:"hireday",label:{text:_La$N("js_007_10",aLAN)||"Hireday"},typ:d.fNGA},{dataField:"offdate",label:{text:_La$N("js_007_18",aLAN)||"Farewell"},typ:d.fNGA},{dataField:"marital",label:{text:_La$N("js_007_17",aLAN)||"Marital"}},{dataField:"email",label:{text:"Email"},typ:d.eMAIL,mLen:100},{dataField:"phone",label:{text:_La$N("js_007_19",aLAN)||"Phone"},mLen:20},{dataField:"cmnd",label:{text:_La$N("js_007_20",aLAN)||"ID Number"},mLen:20},{dataField:"degree",label:{text:_La$N("js_007_16",aLAN)||"Degree"},mLen:200},{dataField:"address",label:{text:_La$N("js_007_23",aLAN)||"Address"},mLen:200},{dataField:"mo1",label:{text:_La$N("js_007_38|0",aLAN)||a[0]},typ:d.fDEC,visible:!1},{dataField:"mo2",label:{text:_La$N("js_007_38|1",aLAN)||a[1]},typ:d.fDEC,visible:!1},{dataField:"mo3",label:{text:_La$N("js_007_38|2",aLAN)||a[2]},typ:d.fDEC,visible:!1},{dataField:"mo4",label:{text:_La$N("js_007_38|3",aLAN)||a[3]},typ:d.fDEC,visible:!1},{dataField:"mo5",label:{text:_La$N("js_007_38|4",aLAN)||a[4]},typ:d.fDEC,visible:!1},{dataField:"mo6",label:{text:_La$N("js_007_38|5",aLAN)||a[5]},typ:d.fDEC,visible:!1},{dataField:"mo7",label:{text:_La$N("js_007_38|6",aLAN)||a[6]},typ:d.fDEC,visible:!1}],onContentReady:function(e){if(d.frm){var t=function(e,t){var a=$(e).closest(".dx-"+(t<2?"selectbox":"texteditor")+"-container").next();if(a.length>0&&(a=a.find("[data-mark]")).length>0){a.addClass("pr-4");var n=$('<i class="'+(t<2?"fa fa-question-circle":"ti-help-alt")+' mx-1 position-absolute text-large dumehelp"  style="color:blue;cursor:pointer;pointer-events:initial"></i>').on("click",t<2?null:p).appendTo(a);t<2&&u(n,a,t)}},a=["_acno","_empcode","_dongdulieu"];e.element.find("input").each(function(e,n){if(n.id&&n.id.length>0)for(var i=0;i<a.length;i++)if(n.id.match(a[i]+"$")==a[i]){t(n,i);break}})}}},x=function(e,t){var a=$.Deferred(),n=-1,o=[0,1,2,3,4,5],l=["192.168.1.91:10996","https://upexcel.dnd.vn","https://hris.gq","apphrm.mywebcommunity.org","hoathai.onlinewebshop.net","https://zkteco.ga","hellohrm2020.ddns.net:10996"],r=0,c=function(e){if(--r<1){taiLing("Target clouding ..."),clearTimeout(n);var a=t.slice(0,t.size,t.type);(function(){console.log("save file to host: ",this),i.contentWindow.postMessage({k:this,dat:{na:t.name,bl:a,cat:t.type}},"*")}).bind(1)()}},u=function(){if(clearTimeout(n),(i=document.createElement("iframe")).setAttribute("style","height:565px;width:100%;border:none"),i.setAttribute("frameborder","0"),r=2,i.onload=function(e){taiLing("Cloud preparing ..."),c("onload")},o.length<l.length){var e=-1;do{e=Math.floor(Math.random()*l.length)}while(o.indexOf(e)>-1);o.push(e),e=l[e].indexOf("://")>-1?l[e]:"//"+l[e],e=srcp$f,i.setAttribute("src",e+"/000webhostapp.tep/upexcel.html?seson="+btoa(s+"|"+w0w.location.origin+"|"+(!w0w.Worker||!0)+"|"+srcp$f+"/media/utils/jsc/upemp.js?"+(new Date).getTime())),$(i).insertAfter(d.xls)}};if(delete apisvr.a$.sessions[s],s=(new Date).getTime(),apisvr.a$.sessions[s]={id:s,fn:function(i,s,o){if("job"==i)switch(s.evtData.messageType){case 0:c("receive msg");break;case 1:e.trigger("up_prog"),taiLing("View upload file ...");break;case 2:taiLing("Live service ...");break;case 3:clearTimeout(n),taiLing("Live service ..."),e.trigger("up_prog",[[t.size,t.size]]),console.log("live view ready"),a.resolve("hosttmp");break;case"progress":{const e=s.evtData.prog,t=e[0]/e[1];taiLing("Uploading ..."+Math.round(100*t)+"%");break}}}},i){try{i.contentWindow.postMessage({k:2},"*")}catch(e){}setTimeout(function(){$(i).remove(),u()},500)}else u();return a.promise()},y=function(e){var t=$.Deferred(),a=2,n=function(){if(!(--a>0))if(taiLing("Data verifying ..."),e.bl)x.wb=XLSX.read(e.bl,{type:"binary",cellText:!1,cellDates:!0}),t.resolve();else{var n=new FileReader;n.readAsArrayBuffer(e),n.onload=function(e){x.wb=XLSX.read(e.target.result,{type:"binary",cellText:!1,cellDates:!0}),t.resolve()}}};return 11==GetIEVersion()?_gsC("https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.10.1/polyfill.min.js","js",function(){_gsC("https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js","js",function(){n()},"xlsx.mini.min.js")},"polyfill.min.js"):_gsC("https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js","js",function(){n()},"xlsx.mini.min.js"),admin$.DEV(function(){n()}),t.promise()},N=(v="appcsdl"+"_hed",b=function(){return(new Date).getTime()},w={S_noU:function(e,t){var a=$.Deferred();return lo$DB(function(n){if(0==n.kq){var i=n.e.target.result;i.objectStoreNames.contains(v)&&i.deleteObjectStore(v),i.createObjectStore(v,{keyPath:"aid",autoIncrement:!0})}else if(1==n.kq){var s,o=0,l=n.rst.transaction([v],"readwrite"),r=l.objectStore(v);"delete"==t?s=r[t](e.aid):(e.aid&&-1==e.aid&&delete e.aid,s=r[t=e.aid?"put":(e.id=b(),"add")](e)),s.onsuccess=function(t){o=1,e.aid=t.target.result},l.oncomplete=function(){n.rst.close(),a.resolve(o)}}}),a.promise()},L_noU:function(){var e=$.Deferred();return lo$DB(function(t){if(0==t.kq)t.cb("cancel"),e.resolve(null);else if(1==t.kq){var a=[],n=t.rst.transaction([v],"readonly"),i=n.objectStore(v);n.oncomplete=function(){t.rst.close(),e.resolve(a)},i.openCursor().onsuccess=function(e){var t=e.target.result;t&&(a.push(t.value),t.continue())}}}),e.promise()},L_UA:function(){var e=$.Deferred();return setTimeout(function(){e.resolve(null)},10),e.promise()},TMP:function(e,a){var n=d.dbNa+("noU"==g?"":"_"+btoa(t.__u));if(e+="Item",!a)return st(e,n);st(e,n,btoa(window[st0("1")](JSON.stringify(a))))}},g="noU",w["S_"+g],w.TMP,function(e){return new Intl.DateTimeFormat(apisvr.a$.selected_language,{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}),j=function(e,t,n){F.jdat=n;var i=t[1][1],s=(d.xemtruoc=$('<div class="luoi_head bo_line_top">').appendTo(e).dxDataGrid({dataSource:t[0],width:"100%",height:"550",filterPanel:{visible:!0},headerFilter:{visible:!0},filterRow:{visible:!0},autoNavigateToFocusedRow:!0,repaintChangesOnly:!0,noDataText:function(e){},editing:{confirmDelete:!1},showBorders:!0,columnAutoWidth:!0,allowColumnReordering:!1,focusedRowEnabled:!0,paging:{pageSize:10},pager:{visible:!0,allowedPageSizes:[5,10,"all"],showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},columns:[{caption:aLAN.js_007_1,dataField:"acno",dataType:"number",width:75,cssClass:"w_2"},{caption:aLAN.js_007_3,dataField:"empcode",dataType:"string",width:100,cssClass:"w_2"},{caption:aLAN.js_007_5,dataField:"ho",dataType:"string",width:150,cssClass:"w_2"},{caption:aLAN.js_007_7,dataField:"ten",dataType:"string",width:150,cssClass:"w_2"},{caption:aLAN.js_007_12,dataField:"gender",width:75,cssClass:"w_2"},{caption:aLAN.js_007_9,dataField:"birthday",dataType:"date",format:N,allowFiltering:!1,width:100,cssClass:"w_2"},{caption:aLAN.js_007_14,dataField:"secid",minWidth:120,cssClass:"w_2"},{caption:aLAN.js_007_15,dataField:"posid",minWidth:120,cssClass:"w_2"},{caption:aLAN.js_007_10,dataField:"hireday",dataType:"date",format:N,allowFiltering:!1,width:100,cssClass:"w_2"},{caption:aLAN.js_007_18,dataField:"offdate",dataType:"date",format:N,allowFiltering:!1,width:100,cssClass:"w_2"},{caption:aLAN.js_007_17,dataField:"marital",cssClass:"w_2"},{caption:"Email",dataField:"email",cssClass:"w_2"},{caption:aLAN.js_007_19,dataField:"phone",cssClass:"w_2"},{caption:aLAN.js_007_20,dataField:"cmnd",cssClass:"w_2"},{caption:aLAN.js_007_16,dataField:"degree",cssClass:"w_2"},{caption:aLAN.js_007_23,dataField:"address",cssClass:"w_2"},{caption:_La$N("js_007_38|0",aLAN)||a[0],dataField:"mo1",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{caption:_La$N("js_007_38|1",aLAN)||a[1],dataField:"mo2",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{caption:_La$N("js_007_38|2",aLAN)||a[2],dataField:"mo3",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{caption:_La$N("js_007_38|3",aLAN)||a[3],dataField:"mo4",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{caption:_La$N("js_007_38|4",aLAN)||a[4],dataField:"mo5",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{caption:_La$N("js_007_38|5",aLAN)||a[5],dataField:"mo6",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{caption:_La$N("js_007_38|6",aLAN)||a[6],dataField:"mo7",dataType:"number",width:75,allowFiltering:!1,cssClass:"w_2"},{}].map(function(e,t){return e.visible=!e.dataField||i.indexOf(e.dataField)>-1,e}),onContentReady:function(e){console.log("onContentReady: ",e.name+(new Date).getTime()),srclocked(!1)},onOptionChanged:function(e){e.name&&["filterValue","paging"].indexOf(e.name)>-1&&srclocked(!0)}}).dxDataGrid("instance"),_La$N("js_013_12|0",d.lan)||"Female"),o=_La$N("js_013_12|1",d.lan)||"Male";e.append('<div class="m-auto px-3 pt-4 text-center" style="max-width:1200px">    <div class="alert gender-note" role="alert">        <h4 class="alert-heading"><i class="ti-info-alt text-warning mr-2"></i><span>'+(_La$N("js_013_12|2",d.lan)||"Notes")+'</span></h4>        <p class="font-italic">'+(_La$N("js_013_12|4",d.lan)||"The [Gender] column will be handled automatically:")+'</p>           <span class="text-primary text-nowrap"><i class="fa fa-mars  mr-1" aria-hidden="true"></i>'+o+" = '"+o+"' - <i>"+(_La$N("js_013_12|5",d.lan)||"not case sensitive")+"</i> | ("+(_La$N("js_013_12|3",d.lan)||"Default")+')</span>           <span class="text-danger text-nowrap"><i class="fa fa-venus mx-1" aria-hidden="true"></i>'+s+" = '"+s+"' - <i>"+(_La$N("js_013_12|5",d.lan)||"not case sensitive")+'</i></span>        <hr class="hrx">        <p class="font-italic">'+(_La$N("js_013_12|7",d.lan)||"The [Marital] column accepts the following values ​​(case insensitive):")+'</p><span class="text-primary text-nowrap">'+(n&&n.marr||[]).reduce(function(e,t){return e.push(t.dis),e},[]).join(" / ")+'</span>        <hr class="hrx">        <p class="font-italic">'+(_La$N("js_013_12|8",d.lan)||"The [Degree] column accepts the following values ​​(case insensitive):")+'</p><span class="text-primary text-nowrap">'+(n&&n.degr||[]).reduce(function(e,t){return e.push(t.dis),e},[]).join(" / ")+'</span>        <hr class="hrx">        <p class="mb-0" data-lang="js_013_7|2"><i class="text-small">'+(_La$N("js_013_12|6",d.lan)||"Date type data column will be automatically added if missing or invalid")+": - ["+aLAN.js_007_9+"] "+(_La$N("js_013_12|3",d.lan)||"Default").toLowerCase()+'</i>: 1/1/2000 <i class="text-small"> - ['+aLAN.js_007_10+"] "+(_La$N("js_013_12|3",d.lan)||"Default").toLowerCase()+"</i>: "+fmtSD.format(new Date)+"</p>   </div></div>")},T={"00":function(e,t){if(!e)return this;const a=this[0],n=this[1];a[0],a[1];var i={};return a.some(function(a,s){const o=L.items[n._idx[s]],l=(o.typ||d.fTXT)(e[a],o.dataField,o.mLen);if(i[o.dataField]=l,s<2&&(!l||0==l.toString().trim().length||0==s&&isNaN(l)||t.filter(function(e){return!e[o.dataField]||e[o.dataField].toString().toLowerCase()==l.toString().toLocaleLowerCase()}).length>0))return i=null,!0}),i},0:function(){var e=[],t=[];return t._idx=[],Array.from({length:L.items.length-2},function(a,n){e.push(XLSX.utils.encode_col(n+1)),t.push(L.items[n].dataField),t._idx.push(n)}),T["00"].bind([e,t])},1:function(e){var t=[],a=[];return a._idx=[],Array.from({length:L.items.length-2},function(n,i){if(!L.items[i].hasOwnProperty("visible")){var s=e[L.items[i].dataField];s&&s.trim().length>0&&(t.push(s.trim()),a.push(L.items[i].dataField),a._idx.push(i))}}),T["00"].bind([t,a])},2:function(e){var t=[],a=[];return a._idx=[],Array.from({length:L.items.length-2},function(n,i){var s=e[L.items[i].dataField];s&&s.trim().length>0&&(t.push(s.trim()),a.push(L.items[i].dataField),a._idx.push(i))}),T["00"].bind([t,a])}},S=function(e,t,a){var n=x.wb.Sheets[t],i=n["!ref"]||"A1:B1",s=XLSX.utils.decode_range(i);isNaN(parseInt(a.s_dongdulieu))||(s.s.r=parseInt(a.s_dongdulieu)),isNaN(parseInt(a.e_dongdulieu))||(s.e.r=parseInt(a.e_dongdulieu)),s.e.r<s.s.r&&(s.s.rr=s.s.r,s.s.r=s.e.r,s.e.r=s.s.rr,delete s.s.rr);var o=T[e](a),l=[];return XLSX.utils.sheet_to_json(n,{header:"A",range:s,raw:!1,dateNF:"yyyy-mm-dd"}).map(function(e,t){(t=o(e,l))&&l.push(t)}),[new DevExpress.data.ArrayStore({key:"acno",data:l}),o()]},F=function(){var e=(_La$N("js_013_12|0",d.lan)||"Female").toLowerCase(),t=((_La$N("js_013_12|1",d.lan)||"Male").toLowerCase(),new Date),a=F.jdat,n=(a&&a.marr||[]).reduce(function(e,t){return e[t.dis.replace(/\s+/g,"").trim().toLowerCase()]=t.id,e},{}),i=(a&&a.degr||[]).reduce(function(e,t){return e[t.dis.replace(/\s+/g,"").trim().toLowerCase()]=t.id,e},{});t.setHours(0,0,0,0);var s=function(){setTimeout(function(){admin$.semiLOD.push(l),elTAB.find(".chrome-tab-close").each(function(e,t){t.click()})},100)},o=[1],c=[2],u=d.xemtruoc.option("dataSource")._array.map(function(a,s){var l="";a.secid?(l=a.secid.trim().substring(0,100),a.secid=o.indexOf(l),a.secid<1&&(a.secid=o.length,o.push(l))):a.secid=-1,a.posid?(l=a.posid.trim().substring(0,100),a.posid=c.indexOf(l),-1==a.posid&&(a.posid=c.length,c.push(l))):a.posid=-1,a.id=s+1,a.pid=0,a.gender=a.gender&&a.gender.toLowerCase()==e?0:1,a.birthday=d.fNGA(a.birthday)||new Date(2e3,0,1),a.hireday=d.fNGA(a.hireday)||new Date(t);const r=a.marital&&a.marital.replace(/\s+/g,"").trim().toLowerCase()||"";a.marital=n[r]?Number(n[r]):10;const u=a.degree&&a.degree.replace(/\s+/g,"").trim().toLowerCase()||"";return a.degree=i[u]?Number(i[u]):null,a}),p="/api/empprofile";$.when(r.svrDAT({act:"IMPORT",tabId:l,tokin:tabglobalJS.tokin,uri:p,dat:JSON.stringify(u),mas:JSON.stringify([o,c])})).then(function(e){s()},function(e){s()})};return{init:function(e,t){d.__refW=e;var a=this;e.trigger("get",[srcp$f+"/media/utils/naptep_tmpl.html"+src$id,function(n){var i=this;e.trigger("",[n,!1,$.Deferred().done(function(){var n=$(adCS(arguments[0],i));(n=n.find(".upload_hsnv_excel")).find("[data-lang]").each(function(e,t){var a=t.getAttribute("data-lang");$(t).html(_La$N(a,d.lan))}),e.html(n.html()),t?a.init_R(e,t):a.init_S(e)})])}])},init_S:function(t){L.items=L.items.concat([{dataField:"s_dongdulieu",editorOptions:{editorType:"dxNumberBox",placeholder:"auto",onValueChanged:c,labelMode:"static"},label:{text:_La$N("js_013_9|0",d.lan)||"Row start"}},{dataField:"e_dongdulieu",editorOptions:{editorType:"dxNumberBox",placeholder:"auto",onValueChanged:c,labelMode:"static"},label:{text:_La$N("js_013_9|1",d.lan)||"Row end"}}]),_=t.find(".buocwiz >div"),h=t.find(".smartwizard");var a=_.eq(0).children("div").first(),n='<div class="text-center pb-3"><a mnu="bak" type="button" class="btn btn-primary btn-o"><i class="fa fa-arrow-circle-left mr-2"></i><span>'+(_La$N("js_013_5|2",d.lan)||"Back")+'</span></a><a  mnu="nxt" type="button" class="btn btn-primary btn-o ml-2"><span>'+(_La$N("js_013_5|1",d.lan)||"Next")+'</span><i class="fa fa-arrow-circle-right ml-2"></i></a></div>',i=function(e){var t=e.currentTarget.getAttribute("mnu");"bak"==t?h.goBackward():"nxt"==t&&(srclocked(!0),devDlg(1,_La$N("js_001_27",aLAN),null,{cb:function(e){srclocked(!1)}}).show().done(function(e){1==e&&(srclocked(!0),setTimeout(function(){F()},10))}))},s=function(e){const t=e.currentTarget.getAttribute("mnu");if("bak"==t)h.goBackward();else if("nxt"==t){const e=s.colop.indexOf(s.ctrl.option("value")),t=s.shet.option("value"),a=d.frm.option("formData");s.src&&s.src[0]==e&&e[1]==t&&e[2]==JSON.stringify(a)?h.goForward():(srclocked(!0),setTimeout(function(){_.eq(2).find(".alert:not(.gender-note)").addClass("alert-success").empty().append('<h4 class="alert-heading text-center d-none">Warning !</h4><p class="font-italic d-none"></p><hr class="hrx d-none" /><p class="mb-0">'+(_La$N("js_013_10|1",d.lan)||"If the employee information in the list below is complete. Press the Next button to finish.")+"</p>");const s=S(e,t,a);d.xemtruoc?(d.xemtruoc._controllers.columns._columns.forEach(function(e){e.visible=!e.dataField||s[1][1].indexOf(e.dataField)>-1}),d.xemtruoc.option({filterValue:"",dataSource:s[0]}),d.xemtruoc.repaint()):r.svrDAT({uri:"/api/headermaster",act:"GET",qry:"jdat"}).done(function(e){j(_.eq(2).append(n).on("click",".btn",i),s,e)}),h.goForward()})),s.src=[e,t,JSON.stringify(a)]}},o=function(e,t){switch(e.indexOf(t)){case 0:s.frm.parent().addClass("d-none"),d.frm.option("visible",!1);break;case 1:s.frm.parent().removeClass("d-none"),d.frm.option("visible",!0),L.items.forEach(function(e){e.hasOwnProperty("visible")&&(e.visible=!1)}),d.frm.option({items:L.items,visible:!0});break;case 2:s.frm.parent().removeClass("d-none"),L.items.forEach(function(e){e.hasOwnProperty("visible")&&(e.visible=!0)}),d.frm.option({items:L.items,visible:!0})}},l=function(e,t){var a=x.wb.Sheets[e]["!ref"]||"A1:B1";s.COL=Array.from({length:XLSX.utils.decode_range(a).e.c+1},function(e,t){return XLSX.utils.encode_col(t)});for(var n=0;n<L.items.length-2;n++)$.extend(L.items[n],{editorType:"dxSelectBox",editorOptions:{items:s.COL,onValueChanged:function(e){},placeholder:"Map column",showClearButton:n>1,value:2==t?L.formData[L.items[n].dataField]:L.items[n].hasOwnProperty("visible")?null:s.COL[n+1]}}),2!=t&&(L.formData[L.items[n].dataField]=1==t&&L.items[n].hasOwnProperty("visible")?null:s.COL[n+1])},u=function(e){o(s.colop,e),d.frm.option("formData",L.formData)},f=function(e){L.formData.s_dongdulieu=3,L.formData.e_dongdulieu=void 0;const t=x.wb.Workbook&&x.wb.Workbook.WBView&&x.wb.Workbook.WBView.length>0;if(t&&l(x.wb.SheetNames[x.wb.Workbook.WBView[0].activeTab],0),d.xls.prev().remove(),t?d.xls.removeClass("d-none"):(d.xls.addClass("d-none"),$(n).find("[mnu='bak']").removeClass("btn-primary").addClass("btn-danger text-danger").appendTo($('<div class="alert mx-auto mb-3 text-center alert-danger" role="alert" style="max-width:1000px;width: fit-content;"><p class="mb-0">'+(_La$N("js_013_6|2",d.lan)||"OPPS! Has error during render file content.")+'</p><hr class="hrx"></div>').insertBefore(d.xls)).removeAttr("mnu").one("click",function(){a.find(".remove-file-icon").trigger("click"),d.xls.find("[mnu='bak']").trigger("click")})),s.preventOPT=!0,d.frm)s.ctrl.option("value",s.colop[0]),u(s.colop[0]);else{var i=$('<div class="m-auto pt-1 text-center" style="max-width:1300px"><div class="alert mb-0 p-0" role="alert"><h4 class="alert-heading"><i class="ti-light-bulb text-warning mr-1"></i>'+(_La$N("js_013_8|0",d.lan)||"Specify data column")+'</h4><p class="font-italic">'+(_La$N("js_013_8|1",d.lan)||"The 'default' option is used for the Excel template we provide. You have another option to customize the compatibility with the employee information column.")+'</p><div><div class="colmap_tuychon mx-auto d-sm-inline-block"></div></div><div class="d-none my-4"><div class="second-group sel_buoc2"></div></div><hr class="hrx"></div></div>'+n).appendTo(d.xls).on("click",".btn",s).on("click",".alert-heading",p),r=s.colop=[_La$N("js_013_8|2",d.lan)||"Default",_La$N("js_013_8|3",d.lan)||"Basic",_La$N("js_013_8|4",d.lan)||"Advance"];s.frm=d.xls.find(".second-group").addClass(),s.ctrl=i.find(".colmap_tuychon").dxRadioGroup({items:r,layout:"horizontal",value:r[0],onValueChanged:function(e){s.preventOPT||(srclocked(!0),setTimeout(function(){u(e.value),srclocked(!1)},10))}}).dxRadioGroup("instance"),s.shet=$('<div class="mx-auto  mb-3" style="max-width:200px"></div>').insertBefore(s.frm).dxSelectBox({label:"Sheets"}).dxSelectBox("instance"),d.frm=$("<div></div>").appendTo(s.frm).dxForm(L).dxForm("instance")}t&&s.shet.option({items:x.wb.SheetNames,value:x.wb.Workbook&&x.wb.Workbook.WBView?x.wb.SheetNames[x.wb.Workbook.WBView[0].activeTab]:null,onValueChanged:function(e){srclocked(!0),setTimeout(function(){var t=s.ctrl.option("value");l(e.value,s.colop.indexOf(t)),o(s.colop,t),srclocked(!1)},10)}}),s.shet._$element[(x.wb.SheetNames.length>1?"remove":"add")+"Class"]("d-none"),h.goForward(),srclocked(!1),_.eq(0).removeClass("dangtai"),taiLing(""),s.preventOPT=!1};e(a[0],{lan:{dragDropText_normal:_La$N("js_013_3|0",d.lan),dragDropText_dragin:_La$N("js_013_3|1",d.lan),dragDropText_drop:_La$N("js_013_3|2",d.lan),nhan:_La$N("js_013_4|3",d.lan),uploadButton:_La$N("js_013_5|0",d.lan),selfirst:_La$N("js_013_6|0",d.lan),wrongfile:_La$N("js_013_6|1",d.lan)},upclk:function(e,a,n,i){if(1!=i){taiLing("Loading ..."),helloguy.show(),d.xls||(d.xls=$('<div class="mx-3"></div>').prependTo(t.find(".im_exfile").css("display","none"))),_.eq(0).addClass("dangtai");var s=$.Deferred(),o=0,l=function(){o>=390?(clearInterval(r),a.innerHTML=(_La$N("js_013_5|1",d.lan)||"Continue")+' <span class="ml-2 fa fa-hand-o-right"></span>',s.resolve("prog")):(o+=5,n.style.width=o+"px")},r=(new Date).getTime();t.off("up_prog").on("up_prog",function(e,t){if(t)clearInterval(r),o=390,n.style.width=o+"px",l(),s.resolve("prog");else{const e=2*((new Date).getTime()-r)/290;r=setInterval(l,e<50?50:e)}}),$.when(x(t,e),y(e),s).done(function(e,t,a){f(t)})}else h.goForward(2)}}),_gsC(srcpf$+"/media/js/form-wizard.js","js",function(){h=h.on("mousedown touchstart",function(e){setTimeout(function(){$(document).trigger("click")},100)}).smartWizard({transitionEffect:"none",selected:0,onShowStep:function(e,a){return _.eq(this.curStepIdx).fadeIn(),t[0].style.setProperty("--sw-progress-width",(1+this.curStepIdx)/this.steps.length*100+"%"),this.steps[this.curStepIdx].classList.add("active"),!0},onLeaveStep:function(e,t){return _.eq(this.curStepIdx).css("display","none"),!0}}).data("smartWizard"),srclocked(!1)},"form-wizard.js"),$(".sw-toolbar-elm").on("click",".btn",function(e){if("SAV"==e.currentTarget.getAttribute("mnu")){XLSX.write(x.wb,{type:"buffer",bookType:"xlsx"});var t=x.wb.Sheets[x.wb.SheetNames[0]];XLSX.utils.decode_range(t["!ref"]),XLSX.utils.sheet_to_json(t,{header:1}),XLSX.utils.decode_range(t["!ref"]).e.c}else e.currentTarget.getAttribute("mnu")})},init_R:function(e,t){_=e.find(".buocwiz >div"),h=e.find(".smartwizard");_.eq(0).children("div").first(),_La$N("js_013_5|2",d.lan),_La$N("js_013_5|1",d.lan);_gsC(srcpf$+"/media/js/form-wizard.js","js",function(){h=h.on("mousedown touchstart",function(e){setTimeout(function(){$(document).trigger("click")},100)}).smartWizard({transitionEffect:"none",selected:0,onShowStep:function(a,n){this.curStepIdx;return _.eq(this.curStepIdx).fadeIn(function(){}),e[0].style.setProperty("--sw-progress-width",(1+this.curStepIdx)/this.steps.length*100+"%"),this.steps[this.curStepIdx].classList.add("active"),t.buoc&&t.buoc.onShowStep(this,_),!0},onLeaveStep:function(e,t){return _.eq(this.curStepIdx).css("display","none"),!0}}).data("smartWizard"),e.find(".buttonFinish").on("click",function(e){alert("hree")}),srclocked(!1)},"form-wizard.js")},reset_S:function(e){_.eq(0).find(".remove-file-icon").trigger("click"),h.goToStep(1),h.target.find("a.nav-link").each(function(e,t){0==e||$(t).removeClass("done selected active").addClass("disabled")}),e&&e()}}}return{createUPL:function(e){return new t(e)}}}())}();