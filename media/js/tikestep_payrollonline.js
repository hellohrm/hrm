var tikestep=function(){"use strict";return function(e,t,n){e.find("#step-2").on("click","kbd:not(.frst)",function(t){var o=t.target.tagName.toLowerCase();if("kbd"==o||"span"==o){t.preventDefault(),t.stopPropagation(),v(),$(document).trigger("click.bs.dropdown.data-api",{causeby:"clearmenu"});var i=$("span"==o?t.target.parentNode:t.target),s=t.target.getBoundingClientRect(),l=e.find(".s2_fuckdrowdown"),r=e.find(".s2_fuckdrowdown_body");r.find(".menuitems").each(function(e,t){var n=t.className.indexOf(i[0].className)>=0?"":"none";if(t.style.display=n,""==n&&(n=$(t).find(":input")).length>0){var o=apisvr.a$.trim(i.find("span:first-child").text());"tab"==o&&(o=""),n.val(o),setTimeout(function(){n.select()},100)}}),r.detach().appendTo(i),l.detach().appendTo(i);var a=function(){if((l=i.find(".s2_fuckdrowdown")).length>0){r=i.find(".s2_fuckdrowdown_body");var e=l.dropdown().data()["bs.dropdown"],t=e._getPopperConfig(),n=function(e){var t=30;s.right<e.popper.width&&(t=e.popper.width-s.right+30),r.find("[class^=arrow]").css("right",t)};t.onCreate=function(e){n(e)},t.onUpdate=function(e){n(e)},t.modifiers.offset={offset:"20,0"},e._getPopperConfig=function(){return t},$(e.constructor._getParentFromElement(l[0])).one("hidden.bs.dropdown",function(e){l.dropdown("dispose")}),l.dropdown("toggle")}else setTimeout(a,20)};setTimeout(a,20)}else if("a"==o){var c=$(t.target).find(":input"),f=$(t.target).closest("kbd").find("span"),u=apisvr.a$.trim($(t.target).attr("f")),p=apisvr.a$.trim(c.length>0?c.val():$(t.target).text()),g=!1;if(""==u)p.length>0&&p!=apisvr.a$.trim(f.text())&&(f.html(p),g=!0);else{if(f.attr("f")!=u){var h=$(t.target).closest("kbd").parent().find(".fdata>span[f='"+u+"']"),_=apisvr.a$.trim(f.text());"b"!=u&&h.attr("f",f.attr("f")).html(""==_?"&nbsp;":_),g=!0}"b"==u?f.html("&nbsp;"):f.html(""==p?"&nbsp;":p),f.attr("f",u)}if(g){var w=!1;n.fileinfo?(w=0!=n.fileinfo.issave,L(w),1==n.fileinfo.issave&&(n.fileinfo=$.extend({},n.fileinfo),n.fileinfo.issave=2)):(n.s3calc&&2==n.stepHis.remLOG&&(w=!0),n.stepHis.remLOG=1),srclocked(!0),setTimeout(function(){x(d($(t.target).closest(".log-ctrl").find("kbd>span"))),w&&m(),srclocked(!1)},10)}}});var o,i=function(e,t){return 0!=apisvr.a$.trim(e).length&&(t.i=e,!0)},s=function(e,t){return t.n=e,!0},l=function(e,t,n){if(e.length<10)return!1;var o=dayjs(e,n);return t.t=o.$d,o.isValid()},r=function(e,t){return!0},a=t("lan"),c="<a class='close' onclick='javascript:$(this).closest(&quot;.popover&quot;).popover(&quot;hide&quot;).data(&quot;bs.popover&quot;).element.showBack = false;'>&times;</a>",f=function(t,n){t||(t=e.find("#step-2  .log-ctrl kbd>span"));var o,i=$(t[0]),s=($(t[t.length-1]),e.find(".fdata.menuitems"));i.text(n.conf.s),n.conf.f.forEach(function(e,n){(o=$(t[n+1])).attr("f",e),"b"==e?o.html("&nbsp;"):o.html(s.find('a[f="'+e+'"]').text())})},d=function(t,o){t||(t=e.find("#step-2  .log-ctrl kbd>span")),o&&f(t,o);for(var a=[],c=$(t[0]),d=apisvr.a$.trim($(t[t.length-1]).text()),u=[],p=apisvr.a$.trim(c.text()),g=1;g<t.length-1;g++)switch($(t[g]).attr("f")){case"i":u.push(i);break;case"n":u.push(s);break;case"t":u.push(l);break;default:u.push(r)}"tab"==p&&(p=/\t/),$.each((n.showinvisibles&&n.showinvisibles.val()||"").split(/\r?\n/),function(e,t){var n=t.split(p);if(n.length>1)for(var o=!0,i={},s=0;s<n.length;s++)if(s<u.length&&!u[s](n[s],i,d)){o=!1;break}o&&i.hasOwnProperty("i")&&i.hasOwnProperty("t")&&a.push(i)}),e.find("span.logok").html(a.length);var v=e.find(".log-sample kbd.frst"),h=new Date,m=new Date;a.length>0?(h=a[0].t,m=a[0].t,a[0].hasOwnProperty("i")&&(v[0].innerHTML=a[0].i),v[1].innerHTML=a[0].hasOwnProperty("n")&&""!=a[0].n?a[0].n:"&nbsp;",a[0].hasOwnProperty("t")&&(v[2].innerHTML=dayjs(a[0].t).format(d))):v.html("&nbsp;");var _=a.reduce(function(e,t){return e[t.i]=e[t.i]||[],e[t.i].push(t),h>t.t&&(h=t.t),m<t.t&&(m=t.t),e},{}),w=[];return $.each(_,function(e,t){var n=t[0],o=t.sort(function(e,t){return e.t-t.t});w.push({acno:e,ten:n.n,logs:t.length,aLogs:$.map(o,function(e,t){return e.t}),minL:dayjs(o[0].t).format(d),maxL:dayjs(o[o.length-1].t).format(d)})}),e.find("span.totalemps").html(w.length),n.allLOGs=[[w,h,m],null,{f:$.map(t,function(e,t){return $(e).attr("f")}),l:a.length,e:w.length,s:apisvr.a$.trim(c.text()),tf:d,p:"",p0:"",p1:"",p2:"",p3:"",p4:"",p5:"",p6:"",p7:"",p8:"",p9:""}],n.allLOGs[0]},u=function(e){return"verifyLOG"==e?d:"LAN"==e?a:"cTIP"==e?c:"uiDEV"==e?x:"hisLOG"==e?y:"logFROMDB"==e?h:"resetUPLOAD"==e?S:"cleanHIS"==e?G:"logCONF"==e?g:"delHISLOG"==e?D:"dogIFRM"==e?C.dogIFRM:"saveDUPHIS"==e?(L(2==n.fileinfo),[C,C.lstORfrm]):"dlgs3"==e?p:void 0},p=function(e,t,n){return DevExpress.ui.dialog.custom({title:a.js_004_18[0],showTitle:!1,messageHtml:a.js_004_18[1],buttons:[{text:a.js_004_18[2],visible:!!n.s3,onClick:function(e){return-2}},{text:a.js_004_18[3],onClick:function(e){return 1}},{text:a.js_003_1,onClick:function(e){return 0}}]})},g=function(){var e=n.allLOGs[2];return e.minL=n.allLOGs[0][1],e.maxL=n.allLOGs[0][2],e},v=function(e){n.selEMP_popover&&n.selEMP_popover.popover("hide"),n.log_fromto_popover&&n.log_fromto_popover.popover("hide"),!e&&n.saveLOCKED_popover&&n.saveLOCKED_popover.popover("hide")},h=function(i,s){C.parent().find(".logFROMDB").off("click").on("click",function(i){helloguy.css("display",""),v(),H(function(){o||(o=new FormWizard.s2log.init(e,t,n,u)),o.lstHis(C.parent())})}).css("display",!i||(!(i[2]>=1)||n.fileinfo)&&i[2]+s<=1?"none":"")},m=function(){var i=function(){return 1==n.stepHis.remLOG&&!n.fileinfo};if(n.puSAVELOG||(n.puSAVELOG=e.find(".saveAttlog"),n.puSAVELOG.on("click",function(i,s){srclocked(!0);var l=$(this);v(s),setTimeout(function(){admin$.DEV(function(){H(function(){o||(o=new FormWizard.s2log.init(e,t,n,u)),o.saveUplog(l,function(e){var t="function"==typeof A;1==e&&(t||toastMsg(a.js_003_ok,"success"),k(["","none"]),R(""),j(3),n.stepHis.isTiCo=1),t&&A(e)},s)})})},10)}),n.puSAVELOG.next().on("click",function(e){_(e,{hide:function(e,t){1===t&&(n.puSAVELOG.parent().css("display","none"),R(""),i()||w(""))},done:function(e){if(i()){srclocked(!0);var t=$.Deferred();$.when(t).then(function(e){srclocked(!1)}),setTimeout(function(){B(t)},10)}else{var o=n.logDAT[n.fileinfo.id];n.fileinfo=$.extend({},o[0]),L(2==o[0].issave),n.showinvisibles.val(o[1].dat),x(d(null,n.fileinfo))}}},[0,5])}),n.saveLOCKED_popover=n.puSAVELOG.parent(),n.saveLOCKED_popover.popover({offset:"100%,10",container:e.find("#step-2"),placement:"bottom",trigger:"manual",html:!0,title:"<i class='ti-alert'/> "+a.js_004_17[1]+c,content:function(){return i()?a.js_004_17[3]:a.js_004_17[2]}})),i())k(["none","none"]),w("none"),n.puSAVELOG.css("display","none"),n.puSAVELOG.next().css("display",""),n.saveLOCKED_popover.fadeIn("fast",function(){n.saveLOCKED_popover.popover("show")});else{var s=!1;n.puSAVELOG.css("display",""),n.puSAVELOG.next().css("display",2==n.fileinfo.issave?"":"none"),0==n.fileinfo.issave?k(["none",""]):2==n.fileinfo.issave&&(w("none"),s=!0),n.saveLOCKED_popover.fadeIn("fast",function(){s&&n.saveLOCKED_popover.popover("show")}),R("none")}},_=function(e,t,n,o){v();var i,s=null,l=admin$.popup({a:"d",t:"function"==typeof n&&n().title||a.js_004_16[n[0]],m:"function"==typeof n&&n().txt||a.js_004_16[n[1]]}),r=l.find("#popupdone");return r.html(a.js_004_3),r.removeClass("btn-secondary").addClass("btn-danger"),r.click(function(e){s=1,l.modal("hide"),t.done&&"function"==typeof t.done&&t.done(e,s)}),r[((i=!0)?"add":"remove")+"Class"]("btn-primary").prop("disabled",!i),o&&o.fnM&&"function"==typeof o.fnM&&o.fnM(l),l.modal("show"),srclocked(!1),l.one("hide.bs.modal",function(e){t.hide&&"function"==typeof t.hide&&t.hide(e,s)}),l},w=function(t){C.rmvHisAttlog||(C.rmvHisAttlog=e.find(".rmvHisAttlog"),C.rmvHisAttlog.on("click",function(e,t){_(e,{hide:function(e,n){1==n?C.rmvHisAttlog.fadeOut("fast"):!n&&t&&t.fnCB&&t.fnCB(n)},done:function(e){var o=$.Deferred(),i={};i[n.fileinfo.id]=!1,$.when(o).then(function(e){G(e,!0),t&&t.fnCB?t.fnCB(1):srclocked(!1)}),y(o,n.dbTBname,{id:-1},i)}},t&&t.dlgTXT?function(){return t.dlgTXT}:[0,3],t)})),C.lstORfrm&&(t="none"),C.rmvHisAttlog.css("display",t)},k=function(t){if(!C.delHisAttlog){var o=e.find(".delHisAttlog"),i=o.clone();i.removeClass("delHisAttlog btn-outline-danger").addClass("btn-warning").css({display:"none",padding:"5px 6px 2px"}).html("<i class='ti-close'></i>"),o.parent().append(i),C.delHisAttlog=[o,i],o.on("click",function(e){_(e,{hide:function(e,t){1===t&&(srclocked(!0),o.fadeOut("fast"),L(!1),n.saveLOCKED_popover&&n.saveLOCKED_popover.css("display","none"))},done:function(e,t){var o=function(){var e=C.dogIFRM.contentWindow.chanelLog[1].log;e[1]=void 0,G(e,!0),srclocked(!1)};D(function(e){var t=C.find(".hislog-list tbody"),i=n.fileinfo.id;if(t.length>0)t.find("tr[idx='"+i+"'] .bntrmv").trigger("click",[-1*parseInt(i)]);else if(e&&"function"==typeof e){var s=$.Deferred();$.when(s).then(function(e){o()}),e(-1*i,s)}else o()},n.fileinfo.id,n.fileinfo.tc3id)}},[0,2])}),i.on("click",function(e){_(e,{hide:function(e,t){1==t&&i.fadeOut("fast")},done:function(e,t){C.currHISID?(srclocked(!0),setTimeout(function(){var e,t,o,i=function(){x(o),n.rst_attlog?n.ReadyEMP=function(e){n.ReadyEMP=null,srclocked(!1)}:srclocked(!1),C.currHISID=null};if(C.lstORfrm)e=n.logDAT[C.currHISID.id],t=[C.lstORfrm[0],e[1],C.lstORfrm[2]];else{if(C.currHISID.isREM){delete n.fileinfo,S(null,!1,!0,!1);var s=function(e,t){n.showinvisibles.val(t),o=d(null,e),i()};if(1==n.stepHis.remLOG){var l=$.Deferred();$.when(l).then(function(e){s({conf:e.conf},e.log),n.stepHis.remLOG=2}),j(1,l)}else s({conf:C.currHISID.conf},C.currHISID.isREM);return}t=[[(e=n.logDAT[C.currHISID.id])[0]],e[1]]}o=S(t,!1,void 0,!1),i()})):(G(null,!1),j(3))}},[0,1])})}w(t[0]),C.delHisAttlog[0].css("display",t[0]),C.delHisAttlog[1].css("display",t[1]),C.delHisAttlog[0].parent().css("display",""==t[0]||""==t[1]?"":"none")},b=function(e,t){e[1].log[2]--;for(var n=e[1].log[0].length-1;n>-1;n--)e[1].log[0][n].id==-1*t&&e[1].log[0].splice(n,1);h(e[1].log,0)},O=!1,L=function(t){O=t,e.find(".selAttlog").css("display",t?"none":""),e.find(".logFROMDB").prop("disabled",t)},y=function(e,o,i,s){if("noU"==n.hasUA)lo$DB(function(t){if(0==t.kq)t.cb("cancel"),e.resolve();else if(1==t.kq){var n,l,r=[],a=0,c=t.rst.transaction(o,s?"readwrite":"readonly"),f=c.objectStore(o[0]);c.oncomplete=function(){t.rst.close(),e.resolve([r,n,a])},f.openCursor().onsuccess=function(e){var t=e.target.result;t?(a+=1,s&&void 0!==s[t.value.id]&&(t.value.issel=s[t.value.id],t.update(t.value)),i&&!function(e){for(var t in i)if(i.hasOwnProperty(t)&&e[t]!=i[t])return"id"==t&&(l=parseInt(i[t])),!1;return!0}(t.value)||r.push(t.value),t.continue()):o.length>1&&r.length>0&&(l=l||r[r.length-1].id,c.objectStore(o[1]).index("LogIndex").get(l).onsuccess=function(e){n=e.target.result})}}});else{var l=$.Deferred(),r=$.Deferred(),a=function(e){var l=C.dogIFRM.contentWindow,a=l.chanelLog,c=function(e){var t=$.grep(a[1].log[0],function(t,n){return"LOG_IN_LST"==o[0]?o[1].indexOf(t.id)>-1:t.id==e.logid});f&&b(a,f),r.resolve([t,e,a[1].log[2]])},f=function(){if(s)for(var e in s)if(s.hasOwnProperty(e)&&parseInt(e)<0)return e;return null}();e&&e(a[1].log[0]),!f&&i&&n.logDAT[i.id]?c(n.logDAT[i.id][1]):-1!=i.id?(t("___").comm1.loghole(l,a[1],"6c6f67717279",{logh:btoa(JSON.stringify([i,s])),logkind:1}),l.cbHwnd=function(e){l.cbHwnd=null,c(e)}):r.resolve([[],void 0,a[1].log[2]])};$.when(l,r).then(function(t,n){e.resolve(n,t)}),s?(t("___").comm1.uaShift(s,"SEL_HIS_LOG",!1).then(function(e){l.resolve(e)}),a(function(e){for(var t=0;t<e.length;t++)s.hasOwnProperty(e[t].id)&&(e[t].issel=s[e[t].id])})):(a(),l.resolve())}},D=function(e,t,o){"noU"==n.hasUA?lo$DB(function(i){var s=i.rst.transaction(n.dbTBname,"readwrite"),l=s.objectStore(n.dbTBname[0]),r=s.objectStore(n.dbTBname[1]);s.oncomplete=function(){i.rst.close();var n=C.dogIFRM.contentWindow.chanelLog;b(n,-1*parseInt(t)),e()},l.delete(t),r.delete(o)}):e(function(e,t){var o={};o[e]=!0,y(t,n.dbTBname,{issel:!0},o)})},H=function(e){_gsC(srcpf$+"/media/js/tikestep_s2.js?"+(new Date).getTime(),"js",function(){e()},"tikestep_s2.js")},x=function(e){n.rst_attlog&&n.rst_attlog.option({dataSource:e[0],paging:{pageIndex:0}}),n.log_fromto_popover&&(n.log_from.option("value",e[1]),n.log_to.option("value",e[2]))},A=-1,C=e.find(".uploadattlog"),S=function(e,t,o,i){C.find(".hislog-list").remove();var s=T(e);if(E(e,t,function(){s||(n.fileinfo?C.dogIFRM.contentWindow.showUpLog(n.fileinfo.file,k):C.dogIFRM.contentWindow.dropzone.removeAllFiles())}),i&&j(3),n.puSAVELOG&&n.puSAVELOG.parent().css("display","none"),R(""),!o)return d(null,n.fileinfo)},I=function(e){var o,i=$('<table style="display:none" class="table hislog-list table-fixed"><thead></thead><tbody style="height: 125px;"></tbody></table>'),s=i.find("thead"),l=null,r=null,c=function(e,t){-1==unlockedHWND&&srclocked(!0),e=parseInt(e);var o=function(e,t){var o=d(null,t),i=$.Deferred(),s=$.Deferred();$.when(i,s).then(function(e,t){srclocked(!1)}),r&&"function"==typeof r?r(e,s):s.resolve("fnCB NULL"),n.rst_attlog?(n.rst_attlog.clearFilter(),n.ReadyEMP=function(e){i.resolve("UI")},x(o)):i.resolve("UI")};if(n.logDAT[e])E([[n.logDAT[e][0]],n.logDAT[e][1]],!1,function(){o("CACHE",n.logDAT[e][0])});else{var i=$.Deferred();$.when(i).then(function(e){E(e,!1,function(){o("DB",e[0][0])})}),y(i,n.dbTBname,{id:e},t)}},f=function(e,t,i,s){if("th"==e.target.tagName.toLowerCase()){-1==unlockedHWND&&srclocked(!0),i&&(i.off("hide.bs.modal"),i.modal("hide"));var l={};o.find("tr:not(.row-sum)").each(function(e,t){l[parseInt(t.getAttribute("idx"))]=!1});var r=$.Deferred();$.when(r).then(function(e){G(e,!1),s&&"function"==typeof s&&s(1),srclocked(!1)}),y(r,n.dbTBname,{id:-1,issel:!0},l)}else t.animate({height:10},200,function(e){t.remove(),s&&"function"==typeof s&&s(1),i&&i.modal("hide")})};s.html("<tr style='font-size:11px'><th class='col-1 center ti-eraser bntrmv'></th><th class='col-5'>"+a.js_004_15[2]+"</th><th class='col-2 center'>Size (Kb)</th><th class='col-2 center'>"+a.js_004_32+"</th><th class='col-2 center'>"+a.js_004_33+"</th></tr>");for(var u=0,p=0,g=0,v=e[0].length-1;v>-1;v--){var h=Math.floor(e[0][v].file.size/1e3),m=!1;u+=e[0][v].conf.l,p+=e[0][v].conf.e,g+=h,e[1]?m=e[1].logid==e[0][v].id:v==e[0].length-1&&(m=!0),o+="<tr idx='"+e[0][v].id+"' "+(m?"class='selected'":"")+"><td class='col-1 ti-close bntrmv center'></td><td class='col-5'>"+e[0][v].file.name+"</td><td class='col-2 text-right'>"+h+"</td><td class='col-2 text-right'>"+e[0][v].conf.l+"</td><td class='col-2 text-right'>"+e[0][v].conf.e+"</td></tr>"}o+="<tr class='row-sum'><td class='col-6 text-right'>"+a.js_004_15[4]+"</td><td class='col-2 text-right'>"+g+"</td><td class='col-2 text-right'>"+u+"</td><td class='col-2 text-right'>"+p+"</td></tr>",i.on("click",".bntrmv",function(e,o){if(e.stopPropagation(),e.preventDefault(),O)n.saveLOCKED_popover.popover("show");else{-1==unlockedHWND&&srclocked(!0);var i=e,s=$(this).parent();o&&!o.u4?f(e,s,null,function(){l.resolve(o)}):setTimeout(function(){!function(e,n,o){a||(a=t("lan"));var i,s="th"==e.target.tagName.toLowerCase(),r=null,c=admin$.popup({a:"d",t:o&&o.dlgTXT.title||a.js_004_16[0],m:o&&o.dlgTXT.txt||a.js_004_16[s?4:3]}),d=c.find("#popupdone");d.html(a.js_004_3),d.removeClass("btn-secondary").addClass("btn-danger"),d.click(function(){r=n.attr("idx"),f(e,n,c,o&&o.fnCB)}),d[((i=!0)?"add":"remove")+"Class"]("btn-primary").prop("disabled",!i),o&&o.fnM&&"function"==typeof o.fnM&&o.fnM(c),c.modal("show"),srclocked(!1),c.one("hide.bs.modal",function(e){l&&(srclocked(!0),l.resolve(r)),!r&&o&&o.fnCB&&o.fnCB(r)})}(i,s,o)},20)}}),(o=i.find("tbody").html(o)).on("click","tr:not(.row-sum)",function(e){if(O)return e.stopPropagation(),e.preventDefault(),void n.saveLOCKED_popover.popover("show");var t,s,a,f=$(this),d=$(e.target).hasClass("bntrmv");d&&(l=new $.Deferred,$.when(l).then(function(e){if(l=null,e){var d,u={},p=function(o){if("-1"!=e){var i=$.Deferred();parseInt(parseInt(t)),$.when(i).then(function(e){d&&d.contentWindow.showUpLog(n.fileinfo.file,k),o?o.resolve("srclocked(false)"):srclocked(!1)}),y(i,n.dbTBname,{id:"noU"==n.hasUA?-1:parseInt(a.attr("idx")),issel:!0},u)}};if(u[parseInt(e)]=!1,t!=a.attr("idx")?(r=function(e,t){r=null,"CACHE"==e?p(t):(d&&d.contentWindow.showUpLog(n.fileinfo.file,k),t.resolve("fnCB_DB"))},c(a.attr("idx"),u)):p(),(d=o.find("tr:not(.row-sum)")).length<=1){C.lstORfrm=null;var g=C.dogIFRM;d=g,i.fadeOut("fast",function(){i.remove(),$(g).css({display:"none",opacity:"1"}).fadeIn()})}else{for(var v=0,h=0,m=0,_=0;_<d.length;_++){var w=$(d[_]).find("td");m+=parseInt(apisvr.a$.trim($(w[2]).text())),v+=parseInt(apisvr.a$.trim($(w[3]).text())),h+=parseInt(apisvr.a$.trim($(w[4]).text()))}(d=o.find("tr.row-sum td"))[1].innerHTML=m,d[2].innerHTML=v,d[3].innerHTML=h,d=null,a.addClass("selected")}}else s&&s.attr("idx")==f.attr("idx")?srclocked(!1):c(f.attr("idx"))})),s=function(e,t){var n=o.find("tr.selected"),i=t.getAttribute("idx");return 0!=n.length&&n.attr("idx")==i||(o.find("tr").removeClass("selected"),$(t).addClass("selected"),l||(-1==unlockedHWND&&srclocked(!0),setTimeout(function(){c(i)},20))),0==n.length?null:n}(0,this),d&&(t=s?s.attr("idx"):0,0==(a=f.next("tr:not(.row-sum)")).length&&(a=$(this).prev("tr")))}),C.append(i),i.fadeIn()},T=function(e){var t=e&&$.grep(e[0],function(e,t){return e.issel}).length>1,n=C.find(".hislog-list"),o=C.find("iframe");return t?(I(e),C.lstORfrm=e,o.length>0&&o.fadeOut("fast",function(){o.css({display:"",opacity:"0"})})):(C.lstORfrm=null,n.length>0&&n.fadeOut("fast",function(){n.remove()}),o.length>0&&o.css({display:"none",opacity:"1"}).fadeIn()),t},E=function(e,t,o){var i="none";if(e&&e[1]){var s;n.showinvisibles.val(e[1].dat);for(var l=e[0].length-1;l>-1;l--)e[0][l].id==e[1].logid&&(s=e[0][l]);s.tc3id=e[1].id,n.logDAT[s.id]||(n.logDAT[s.id]=[s,e[1]]),n.fileinfo=s,i=""}k([i,"none"]),o&&"function"==typeof o&&o(),t&&h(e,0)},M=function(i){Main.isMobile()?o&&1==n.showlistLOG?o.upload_attlog():(d(),i&&(m(),srclocked(!1))):H(function(){o||(o=new FormWizard.s2log.init(e,t,n,u)),o.upload_attlog()})},G=function(e,t){delete n.fileinfo,n.showinvisibles.val("");var o=S(e,t,void 0,!1);return x(o),o},j=function(e,t){var o="cmVtX2F0dGxvZw==",i="noU"==n.hasUA?1:2,s=function(t){lo$DB(function(o){if(0==o.kq){var s=o.e.target.result;s.objectStoreNames.contains("remLOG")&&s.deleteObjectStore("remLOG"),s.createObjectStore("remLOG",{keyPath:"id"})}else if(1==o.kq){var l,r=o.rst.transaction(["remLOG"],0==e?"readonly":"readwrite").objectStore("remLOG");1==e?l=r.get(i):2==e&&(l=r.put({id:i,conf:g(),log:n.showinvisibles.val()})),l.onsuccess=function(n){2==e?t(n.target.result):t&&t.resolve(n.target.result)}}},"hellohrm_remlog")};if(0==e)return(l=st("getItem",o))&&l.split(i).length>1;if(1==e)s(t);else if(2==e)1==n.stepHis.remLOG&&((l=st("getItem",o))?-1==(l=JSON.parse(l)).indexOf(i)&&l.push(i):l=[i],s(function(){st("setItem",o,JSON.stringify(l)),n.stepHis.remLOG=2}),n.saveLOCKED_popover&&n.saveLOCKED_popover.css("display","none"));else if(3==e){var l;0!=n.stepHis.remLOG&&(l=st("getItem",o))&&(l=JSON.parse(l),l=$.grep(l,function(e){return e!=i}),st((l.length>0?"set":"remove")+"Item",o,JSON.stringify(l))),n.stepHis.remLOG=0}},B=function(e){var t=$.Deferred();$.when(t).then(function(t){n.showinvisibles.val(t.log),d(null,{conf:t.conf}),n.stepHis.remLOG=2,e.resolve()}),j(1,t)},R=function(t){e.find(".selAttlog .samplefile").css("display",t)},P=function(){var e,t=admin$.popup({a:"f"}),o=function(e){e.find(".btn").on("click",function(e){var t=$(this).attr("dn");srclocked(!0),setTimeout(function(){i(t)},10)}),t.find(".modal-body").append(e),setTimeout(function(){t.one("shown.bs.modal",function(){}).modal("show")},1),srclocked(!1)},i=function(o){var i=JSON.parse(e[o]);$.get(srcp$f+"/media/utils/"+i.p+src$id).done(function(e){var o={u4:"clean4download",dlgTXT:{title:a.__exLAN.dlg[0],txt:a.__exLAN.dlg[1]},fnM:function(e){e.find(".modal-dialog").removeClass("modal-sm").addClass("modal-md")},fnCB:function(o){1==o?(t.modal("hide"),f(null,{conf:i}),n.showinvisibles.val(e),M(!1),n.showinvisibles.trigger("change",["samlog"])):t.css("opacity",1)}};C.lstORfrm?(t.css("opacity",0),C.find("th.bntrmv").trigger("click",[o])):n.fileinfo?(t.css("opacity",0),C.rmvHisAttlog.trigger("click",[o])):o.fnCB(1)}).fail(function(e){srclocked(!1)})};n.logsample_templ?(o(n.logsample_templ),e=C.dogIFRM.contentWindow.__logSAM.conf()):$.get(srcp$f+"/media/utils/lst.html"+src$id).done(function(t){var i=$(t).find(".pricing-table-log"),s=apisvr.a$.selected_language,l=C.dogIFRM.contentWindow,r=i.find("script"),c=r[0].innerHTML;r.remove(),n.logsample_templ=i,l.__doHandshake=function(){l.__doHandshake=null,a.__exLAN=$.extend({}||a.__exLAN,l.__logSAM.exLAN()[s]),e=l.__logSAM.conf(),l=l.__logSAM.ln(),"en"!=s&&n.logsample_templ.find("[data-lang]").each(function(e,t){var n=t.getAttribute("data-lang");$(t).html(l[s][n])})},l.loadjscssfile(c,"jst"),o(n.logsample_templ)}).fail(function(e){srclocked(!1)}),t.find("#popupdone").remove(),t.find(".modal-footer").css("justify-content","center").find("button").removeClass("btn-secondary").addClass("btn-danger"),t.addClass("modal-aside vertical top")};this.doStep=function(i,s,l,r){if(v(),"2"==s.fromStep.toString()&&(n.selEMP_popover&&n.selEMP_popover.popover("hide"),n.log_fromto_popover&&n.log_fromto_popover.popover("hide")),"2"==s.toStep.toString()){if(n[r[0]]?n[r[0]].showBack&&n[r[0]].popover("show"):(n[r[0]]=e.find(".testupload .needuptclick"),n[r[0]],n[r[0]].parent().on("click",function(){srclocked(!0),v(),admin$.DEV(function(){H(function(){o||(o=new FormWizard.s2log.init(e,t,n,u)),n.ReadyEMP=function(e){n.ReadyEMP=null,n.showlistLOG=1,srclocked(!1)},o.grid_attlog()}),srclocked(!1)})})),!n[r[1]]){var c=$.Deferred(),f=$.Deferred(),_=$.Deferred(),w=$.Deferred(),b={issel:!0};j(0)?(b.id=-1,delete b.issel,B(w)):w.resolve(),"noU"==n.hasUA?($.when(c).then(function(e){var t=T(e);E(e,!0,function(){_.resolve([t,e])})}),$.when(f,_,w).then(function(e,t){var o=t[0],i=t[1];!o&&n.fileinfo&&e[0].contentWindow.showUpLog(n.fileinfo.file,k),i&&d(null,n.fileinfo),e[0].contentWindow.chanelLog=[,{log:i||[[],void 0,0]}],e[1]()}),y(c,n.dbTBname,b)):$.when(f).then(function(e){var o=t("alog");if(o.key){var i=[$.grep(o.log[0],function(e,t){return e.issel===b.issel}),null,o.log[2]],s=T(i),l=e[0].contentWindow;i[0].length>0?(l.cbHwnd=function(t){l.cbHwnd=null,i[1]=t,E(i,!0,function(){!s&&n.fileinfo&&e[0].contentWindow.showUpLog(n.fileinfo.file,k),d(null,n.fileinfo),e[1]()})},t("___").comm1.loghole(l,o,"4c4f475f4c4f4144",{logh:btoa(JSON.stringify(["L",i[0][i[0].length-1].id])),logkind:1})):(l.chanelLog=[,o],h(o,0),e[1]())}else T([[],null,0]),e[1]()}),function(e){var o,i,s=n.s2_session,l="/"!=apisvr.a$.mainHolePath?(o=window.location.protocol+"//"+apisvr.a$.mainHolePath,(i=document.createElement("a")).href=o,i.pathname):"";if(0==C.find("iframe").length){var r,c=helloguy.clone();c.css({display:"",position:"absolute",height:"200px"}).removeAttr("id"),C.append(c),apisvr.a$.sessions[s]={hwndTO:null,id:s,fn:function(t,o,i){if("postmsg"==t){var s=C.find("#ifrm_"+o)[0].contentWindow;s.focus(),s.postMessage({msgtype:"session",msgkind:o,evtData:{a$:"olshift"}},"*")}else"job"==t&&("loaded"==o.evtData.evt?(clearTimeout(void 0),this.origin=o.evtData.origin,e.resolve([r,function(){c.remove()}])):"attlog"==o.evtData.evt?(n.fileinfo?C.currHISID=$.extend({},n.fileinfo):0!=n.stepHis.remLOG?C.currHISID={isREM:n.showinvisibles.val(),conf:g()}:C.currHISID=null,n.showinvisibles.val(o.evtData.dat),n.fileinfo={file:o.evtData.file,issave:0,issel:!0,uptime:new Date},r.style.opacity=1,C.find(".table.hislog-list").remove(),M(!0),n.trapHwnd=m):"function"==typeof this[o.evtData.evt]&&this[o.evtData.evt](t,o,i))}},C.find("iframe").remove(),(r=document.createElement("iframe")).style.opacity=1,r.style.display="none",r.style.width="100%",r.style.height="300px",r.setAttribute("scrolling","no"),r.setAttribute("frameBorder","0"),r.src=l+"/chamcong/iframeattlog."+t("___").comm1.uplog+"#"+window[st0("1")](s+"|"+apisvr.a$.mainHolePath+"|"+window.location.origin+"|"+GetIEVersion()+"|"+$("#app").hasClass("darkcolor")),r.onload=function(){r.contentWindow.lan(a.js_004_12),C.dogIFRM=r},C[0].appendChild(r)}}(f),n[r[1]]=e.find("."+r[1]),n[r[1]].off("change").on("change",function(e,t){-1==unlockedHWND&&srclocked(!0);var o=!1;n.fileinfo?(o=0!=n.fileinfo.issave,L(o),1==n.fileinfo.issave&&(n.fileinfo=$.extend({},n.fileinfo),n.fileinfo.issave=2)):(n.s3calc&&2==n.stepHis.remLOG&&(o=!0),n.stepHis.remLOG=1),setTimeout(function(){"samlog"!=t&&x(d()),o&&(m(),n.stepHis.isTiCo=1),"function"==typeof A?A():srclocked(!1)},20)}),e.find(".dropzonecmd").on("click",".selAttlog",function(e){if($(event.target).hasClass("upfile")){v();var t=C.dogIFRM;t&&t.contentWindow.clickE()}else srclocked(!0),setTimeout(P,20)}),e.find(".attlog_verify").off("mousedown touchstart").on("mousedown touchstart",function(e){unlockedHWND=0,A=function(){A=-1},frmWizHwnd.pStep=function(e){frmWizHwnd.pStep=null;var t=function(t){n.lockstep(i,!1),-1==["0"].indexOf(t.toString())&&e(),srclocked(!1)};n.fileinfo&&1!=n.fileinfo.issave?(A=function(e){A=-1,-2==e&&(n.stepHis.viewBackS3=e),t(e)},n.puSAVELOG.trigger("click",[{s3:!!n.s3calc}])):1==n.stepHis.remLOG&&n.s3calc?(p(null,null,{s3:!!n.s3calc}).show().done(function(e){0==e?n.lockstep(i,!1):(-2==e&&(n.stepHis.viewBackS3=e),t(-2==e?2:e))}),srclocked(!1)):t(1)}})}}else"3"==s.toStep.toString()&&(n.lockstep(i,!0),_gsC(srcpf$+"/media/js/tikestep_s3.js"+src$id,"js",function(){var t=function(){n.s3calc.viewBack(n,e,function(){n.lockstep(i,!1)})};if("0"==l)t();else if(n.stepHis.viewBackS3)t(),delete n.stepHis.viewBackS3;else if(1==n.stepHis.isTiCo){n.allLOGs||d();var o=function(){-1!=unlockedHWND&&srclocked(!1),n.selEMP_popover&&"mixed"==n.selEMP_popover.attr("aria-checked")?n.allLOGs[1]=n.rst_attlog.getSelectedRowKeys():n.allLOGs[1]=null,n.s3calc.exec(n,e,function(){j(2),n.lockstep(i,!1),n.stepHis.isTiCo=0,A=-1})};n.s3calc?o():(n.s3calc=FormWizard.s3calc.createCalc({kind:"noshift",Args:{lockStep:function(e){n.lockstep(i,e)},tinhlaiCHK:function(e){n.fileinfo&&1!=n.fileinfo.issave?(A=function(t){e(t)},n.puSAVELOG.trigger("click",[{dupmsg:a.js_004_15[5]}])):1==n.stepHis.remLOG?p(null,null,{s3:!1}).show().done(function(t){e(t)}):e(1)},LAN:a}}),o())}else n.s3calc?t():n.lockstep(i,!1)},"tikestep_s3.js"))}}}();
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){"use strict";var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",s="minute",u="hour",a="day",o="week",f="month",h="quarter",c="year",d="date",$="Invalid Date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},g={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},D="en",v={};v[D]=M;var p=function(t){return t instanceof _},S=function(t,e,n){var r;if(!t)return D;if("string"==typeof t)v[t]&&(r=t),e&&(v[t]=e,r=t);else{var i=t.name;v[i]=t,r=i}return!n&&r&&(D=r),r||!n&&D},w=function(t,e){if(p(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=g;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t)}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(l);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===$)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),$=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},l=function(t,e){return O.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(h){case c:return r?$(1,0):$(31,11);case f:return r?$(1,M):$(0,M+1);case o:var D=this.$locale().weekStart||0,v=(y<D?y+7:y)-D;return $(r?m-v:m+(6-v),M);case a:case d:return l(g+"Hours",0);case u:return l(g+"Minutes",1);case s:return l(g+"Seconds",2);case i:return l(g+"Milliseconds",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h="set"+(this.$u?"UTC":""),$=(n={},n[a]=h+"Date",n[d]=h+"Date",n[f]=h+"Month",n[c]=h+"FullYear",n[u]=h+"Hours",n[s]=h+"Minutes",n[i]=h+"Seconds",n[r]=h+"Milliseconds",n)[o],l=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[$](l),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else $&&this.$d[$](l);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,$=this;r=Number(r);var l=O.p(h),y=function(t){var e=w($);return O.w(e.date(e.date()+Math.round(t*r)),$)};if(l===f)return this.set(f,this.$M+r);if(l===c)return this.set(c,this.$y+r);if(l===a)return y(1);if(l===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[l]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this;if(!this.isValid())return $;var n=t||"YYYY-MM-DDTHH:mm:ssZ",r=O.z(this),i=this.$locale(),s=this.$H,u=this.$m,a=this.$M,o=i.weekdays,f=i.months,h=function(t,r,i,s){return t&&(t[r]||t(e,n))||i[r].substr(0,s)},c=function(t){return O.s(s%12||12,t,"0")},d=i.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:O.s(a+1,2,"0"),MMM:h(i.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:h(i.weekdaysMin,this.$W,o,2),ddd:h(i.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,"0"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:r};return n.replace(y,(function(t,e){return e||l[t]||r.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,$){var l,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,g=this-M,D=O.m(this,M);return D=(l={},l[c]=D/12,l[f]=D,l[h]=D/3,l[o]=(g-m)/6048e5,l[a]=(g-m)/864e5,l[u]=g/n,l[s]=g/e,l[i]=g/t,l)[y]||g,$?D:O.a(D)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return v[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),b=_.prototype;return w.prototype=b,[["$ms",r],["$s",i],["$m",s],["$H",u],["$W",a],["$M",f],["$y",c],["$D",d]].forEach((function(t){b[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=v[D],w.Ls=v,w.p={},w}));