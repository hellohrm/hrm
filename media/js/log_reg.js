String.prototype.format=function(){var t=this;for(var a in arguments)t=t.replace("{"+a+"}",arguments[a]);return t};var LoginModalController={tabsElementName:".logmod__tabs li",tabElementName:".logmod__tab",inputElementsName:".logmod__form .input",hidePasswordName:".hide-password",submitBTNClick:null,inputElements:null,tabsElement:null,tabElement:null,hidePassword:null,$activeTab:null,tabSelection:0,findElements:function(){return this.tabsElement=$(this.tabsElementName),this.tabElement=$(this.tabElementName),this.inputElements=$(this.inputElementsName),this.hidePassword=$(this.hidePasswordName),this},setState:function(t){var a=null;return t||(t=0),this.tabsElement&&((a=$(this.tabsElement[t])).addClass("current"),this.$activeTab=$("."+a.attr("data-tabtar")),this.$activeTab.addClass("show")),this},getActiveTab:function(){var t=this;return t.tabsElement.each(function(a,n){$(n).hasClass("current")&&(t.activeTab=$(n))}),t},addClickEvents:function(){var t=this;return t.hidePassword.on("click",function(t){var a=$(this),n=a.prev("input");n.toggleClass("fuckpass"),n.hasClass("fuckpass")?a.text(dicLAN.js_001_22):a.text(dicLAN.js_001_23)}),t.tabsElement.on("click",function(a){var n=$(this).attr("data-tabtar");a.preventDefault(),t.activeTab.removeClass("current"),t.activeTab=$(this),t.activeTab.addClass("current"),t.tabElement.each(function(a,i){(i=$(i)).removeClass("show"),i.hasClass(n)&&(i.addClass("show"),t.$activeTab=i)})}),t.inputElements.find("label").on("click",function(t){$(this).next("input").focus()}),t},hwData:function(t,a,n){$.post(t,a,function(){}).done(function(t){n&&n({rst:"ok",dat:t})}).fail(function(t,a,i){n&&n({rst:"ng",dat:t})}).always(function(){})},lockfrm:function(t){window.parent.location!=self.location?window.parent.postMessage({msgtype:"session",msgkind:hash[0],evtData:{evt:"lockform",origin:window.location.origin,state:t}},hash[2]):$("#helloguy").css("display",t)},hwndMsg:function(t){t.data.msgtype},captfn:function(t,a){var n=$(t).closest("form"),i=n.find("#captcha");$("#token").val(a.token),n.find("#captchaImg").html('<img src="'+a.captcha+'"/>'),i.val(""),i.parent()[(a.hasOwnProperty("err")&&"2"==a.accStatus?"add":"remove")+"Class"]("err")},validBASE:function(t,a){var n=this,i=function(){var i=a();return t.data("validation",{err:i}),t.parent()[(""==i?"remove":"add")+"Class"]("err"),n.errDisplay(),i};return t.off("blur").on("blur",function(){return i()}),i()},validEmail:function(t){return this.validBASE(t,function(){var a="";if(""==t.val())a=dicLAN.js_001_17;else{var n=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;n.test(t.val());n.test(t.val())||(a=dicLAN.js_001_17)}return a})},validRegPass:function(t){return this.validBASE(t,function(){var a="";return t.val().length<5&&(a=dicLAN.js_001_18.format("5")),a})},validRegPassAgain:function(t,a){return this.validBASE(a,function(){var n="";return t.val()!=a.val()&&(n=dicLAN.js_001_19),n})},validCaptcha:function(t){return this.validBASE(t,function(){var a="";return""==t.val()&&(a=dicLAN.js_001_20),a})},errDisplay:function(){var t=[];if(this.$activeTab.find(".err").each(function(a,n){t.push("<kbd>"+$(n).find("input").data("validation").err+"</kbd>")}),this.$activeTab.find(".errmsg").css("display",t.length>0?"":"none").html(t.join("")),0==t.length){var a=this;setTimeout(function(){a.submitBTNClick&&a.submitBTNClick.trigger("click")},200)}},register:function(t,a){a.submitBTNClick=null;var n=$(t).closest("form"),i=n.find(".errmsg"),e=n.find("#reg-email"),s=n.find("#captcha"),r=$("#token"),o=n.find("#user-pw"),l=n.find("#user-pw-repeat");if(n.find(".err").removeClass("err"),a.validEmail(e),""==a.validRegPass(o)&&a.validRegPassAgain(o,l),a.validCaptcha(s),!(this.$activeTab.find(".err").length>0)){a.lockfrm("");var c=$(t),d=n.serializeArray();d.push({name:"token",value:r.val()},{name:"session",value:hash[0]}),a.hwData("/dangky?XDEBUG_SESSION_START=154A5348",d,function(t){if("ok"==t.rst){var n=JSON.parse(t.dat);if(e.parent()[("1"==n.accStatus?"add":"remove")+"Class"]("err"),"0"!=n.accStatus){a.captfn(c,n),i.css("display","");for(var s=0;s<n.err.length;s++)n.err[s]="<kbd>"+dicLAN[n.err[s]]+"</kbd>";i.html(n.err.join(""))}else a.$activeTab.find("#regokmsg").css("display",""),a.$activeTab.find(".logmod__form").css("display","none");a.lockfrm("none")}})}},login:function(t,a){a.submitBTNClick=null;var n=$(t).closest("form"),i=n.find(".errmsg"),e=n.find("#log-email"),s=n.find("#loginpw"),r=$("#token");if(a.validEmail(e),a.validRegPass(s),!(this.$activeTab.find(".err").length>0)){a.lockfrm("");$(t);var o=n.serializeArray();o.push({name:"token",value:r.val()},{name:"session",value:hash[0]}),setTimeout(function(){a.hwData("/dangnhap?XDEBUG_SESSION_START=154A5348",o,function(t){if("ok"==t.rst){var n=JSON.parse(t.dat);if("-1"==n.accStatus)i.css("display","").html(dicLAN.js_001_7),s.val(""),a.lockfrm("none");else if("-2"==n.accStatus){var e=$(".logmod");e.html(n.html),e.find("[data-lang]").each(function(t,a){var n=a.getAttribute("data-lang");a.innerHTML=dicLAN[n]}),a.lockfrm("none")}else window.parent.postMessage({msgtype:"session",msgkind:hash[0],evtData:{evt:"loginok",origin:window.location.origin,html:n.html}},hash[2])}})},20)}},initialize:function(){var t=this;t.findElements().setState("log"==hash[4]?0:1).getActiveTab().addClickEvents(),$("#createacc").on("mousedown touchstart",function(){t.submitBTNClick=$(this)}).click(function(){t.register(this,t)}),$("#recreateacc").click(function(){t.$activeTab.find("#regokmsg").css("display","none");var a=t.$activeTab.find(".logmod__form");a.css("display",""),a.find(".errmsg").css("display","none").html(""),a.find("#reg-email").off("blur").val(""),a.find("#captcha").off("blur").val(""),a.find("#user-pw").off("blur").val(""),a.find("#user-pw-repeat").off("blur").val(""),a.find("#captcha").off("blur").val(""),a.find(".refreshbtn").trigger("click")}),$("#login").on("mousedown touchstart",function(){t.submitBTNClick=$(this)}).click(function(){t.login(this,t)}),$(".refreshbtn").click(function(){$(this.parentNode).css("display","none"),$(this.parentNode.parentNode).find("#captchaImg").html('<div class="spinner-border" style="margin-top: 5px;float: none;" role="status"><span class="sr-only">Loading...</span></div>');var a=$(this),n=$("#regform").serializeArray();n.push({name:"token",value:$("#token").val()}),t.hwData("/renewcaptcha?XDEBUG_SESSION_START=154A5348",n,function(n){if("ok"==n.rst){var i=JSON.parse(n.dat);t.captfn(a,i),a.parent().css("display","")}})}),$(".logmod").on("click",".logmod__close",function(){window.parent.postMessage({msgtype:"session",msgkind:hash[0],evtData:{evt:"closed",origin:window.location.origin}},hash[2])}),window.parent.location!=self.location&&(window.parent.postMessage({msgtype:"session",msgkind:hash[0],evtData:{evt:"loaded",origin:window.location.origin}},hash[2]),window.addEventListener?window.addEventListener("message",t.hwndMsg,!1):window.attachEvent&&window.attachEvent("onmessage",t.hwndMsg)),$("input.string,input.sumbit").keypress(function(a){if(13==a.which){a.preventDefault();var n=t.$activeTab.find("[tabIndex="+(+this.tabIndex+1)+"]");n.length||(n=t.$activeTab.find("[tabIndex=1]")),n.focus().click()}}),$("input#loginpw").bind("copy",function(t){t.preventDefault()}),$(".logmod__wrapper").fadeIn()}};$(document).ready(function(){$("[data-lang]").each(function(t,a){var n=a.getAttribute("data-lang");a.innerHTML=dicLAN[n]}),LoginModalController.initialize(),$("script").remove()});