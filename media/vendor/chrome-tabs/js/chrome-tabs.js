"use strict";"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var a=arguments[n];if(null!=a)for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])}return i},writable:!0,configurable:!0});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t,e){"function"==typeof define&&define.amd?define(["draggabilly"],function(i){return e(t,i)}):"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e(t,require("draggabilly")):t.ChromeTabs=e(t,t.Draggabilly)}(window,function(t,e){var i=function(t){},n={title:"New tab",favicon:!1},a=0;return function(){function e(){_classCallCheck(this,e),this.draggabillies=[]}return _createClass(e,[{key:"init",value:function(t,e){this.resizeEvt=e,this.el=t,this.instanceId=a,this.el.setAttribute("data-chrome-tabs-instance-id",this.instanceId),a+=1,this.setupCustomProperties(),this.setupStyleEl(),this.setupEvents(),this.layoutTabs(),this.setupDraggabilly()}},{key:"emit",value:function(t,e){try{this.el.dispatchEvent(new CustomEvent(t,{detail:e}))}catch(n){var i;"function"==typeof Event?i=new Event(t,{detail:e}):(i=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,e),this.el.dispatchEvent(i)}}},{key:"setupCustomProperties",value:function(){this.el.style.setProperty("--tab-content-margin","9px")}},{key:"setupStyleEl",value:function(){this.styleEl=document.createElement("style"),this.el.appendChild(this.styleEl)}},{key:"setupEvents",value:function(){var e=this;t.addEventListener("resize",function(t){e.resizeEvt&&e.resizeEvt(),e.cleanUpPreviouslyDraggedTabs(),e.layoutTabs()}),this.tabEls.forEach(function(t){return e.setTabCloseEventListener(t)})}},{key:"layoutTabs",value:function(){var t=this,e=this.tabContentWidths;this.tabEls.forEach(function(t,i){var n=e[i],a=n+18;t.style.width=a+"px",t.removeAttribute("is-small"),t.removeAttribute("is-smaller"),t.removeAttribute("is-mini"),n<84&&t.setAttribute("is-small",""),n<60&&t.setAttribute("is-smaller",""),n<48&&t.setAttribute("is-mini","")});var i="";this.tabPositions.forEach(function(e,n){i+='\n          .chrome-tabs[data-chrome-tabs-instance-id="'+t.instanceId+'"] .chrome-tab:nth-child('+(n+1)+") {\n            transform: translate3d("+e+"px, 0, 0)\n          }\n        "}),this.styleEl.innerHTML=i}},{key:"createNewTabEl",value:function(){var t=document.createElement("div");return t.innerHTML='\n    <div class="chrome-tab">\n      <div class="chrome-tab-dividers"></div>\n      <div class="chrome-tab-background">\n        <svg version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><symbol id="chrome-tab-geometry-left" viewBox="0 0 214 36"><path d="M17 0h197v36H0v-2c4.5 0 9-3.5 9-8V8c0-4.5 3.5-8 8-8z"/></symbol><symbol id="chrome-tab-geometry-right" viewBox="0 0 214 36"><use xlink:href="#chrome-tab-geometry-left"/></symbol><clipPath id="crop"><rect class="mask" width="100%" height="100%" x="0"/></clipPath></defs><svg width="52%" height="100%"><use xlink:href="#chrome-tab-geometry-left" width="214" height="36" class="chrome-tab-geometry"/></svg><g transform="scale(-1, 1)"><svg width="52%" height="100%" x="-100%" y="0"><use xlink:href="#chrome-tab-geometry-right" width="214" height="36" class="chrome-tab-geometry"/></svg></g></svg>\n      </div>\n      <div class="chrome-tab-content">\n        <div class="chrome-tab-favicon"></div>\n        <div class="chrome-tab-title"></div>\n        <div class="chrome-tab-drag-handle"></div>\n        <div class="chrome-tab-close"></div>\n      </div>\n    </div>\n  ',t.firstElementChild}},{key:"addTab",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e.animate,a=void 0===i||i,r=e.background,s=void 0!==r&&r,o=this.createNewTabEl();o.tabProperties=t,a&&(o.classList.add("chrome-tab-was-just-added"),setTimeout(function(){return o.classList.remove("chrome-tab-was-just-added")},500)),t=Object.assign({},n,t),this.tabContentEl.appendChild(o),this.setTabCloseEventListener(o),this.updateTab(o,t),this.emit("tabAdd",{tabEl:o}),s||this.setCurrentTab(o),this.cleanUpPreviouslyDraggedTabs(),this.layoutTabs(),this.setupDraggabilly()}},{key:"setTabCloseEventListener",value:function(t){var e=this;t.querySelector(".chrome-tab-close").addEventListener("click",function(i){return i.preventDefault(),i.stopPropagation(),e.removeTab(t)})}},{key:"hasActiveTab",value:function(){return!!this.activeTabEl}},{key:"setCurrentTab",value:function(t){var e=this.activeTabEl;e!==t&&(e&&e.removeAttribute("active"),t.setAttribute("active",""),this.emit("activeTabChange",{tabEl:t}))}},{key:"removeTab",value:function(t){t===this.activeTabEl&&(t.nextElementSibling?this.setCurrentTab(t.nextElementSibling):t.previousElementSibling&&this.setCurrentTab(t.previousElementSibling)),t.parentNode.removeChild(t),this.emit("tabRemove",{tabEl:t}),this.cleanUpPreviouslyDraggedTabs(),this.layoutTabs(),this.setupDraggabilly()}},{key:"updateTab",value:function(t,e){t.querySelector(".chrome-tab-title").textContent=e.title;var i=t.querySelector(".chrome-tab-favicon");e.tabicon?(i.innerHTML=e.tabicon,i.removeAttribute("hidden","")):e.favicon?(i.style.backgroundImage="url('"+e.favicon+"')",i.removeAttribute("hidden","")):(i.setAttribute("hidden",""),i.removeAttribute("style")),e.id&&t.setAttribute("data-tab-id",e.id)}},{key:"cleanUpPreviouslyDraggedTabs",value:function(){this.tabEls.forEach(function(t){return t.classList.remove("chrome-tab-was-just-dragged")})}},{key:"setupDraggabilly",value:function(){var t=this,e=this.tabEls;this.tabPositions;this.isDragging&&(this.isDragging=!1,this.el.classList.remove("chrome-tabs-is-sorting"),this.draggabillyDragging.element.classList.remove("chrome-tab-is-dragging"),this.draggabillyDragging.element.style.transform="",this.draggabillyDragging.dragEnd(),this.draggabillyDragging.isDragging=!1,this.draggabillyDragging.positionDrag=i,this.draggabillyDragging.destroy(),this.draggabillyDragging=null),this.draggabillies.forEach(function(t){return t.destroy()}),e.forEach(function(e,i){e.onclick=function(e){e.preventDefault(),e.stopPropagation(),t.setCurrentTab(this)}})}},{key:"animateTabMove",value:function(t,e,i){i<e?t.parentNode.insertBefore(t,this.tabEls[i]):t.parentNode.insertBefore(t,this.tabEls[i+1]),this.emit("tabReorder",{tabEl:t,originIndex:e,destinationIndex:i}),this.layoutTabs()}},{key:"tabEls",get:function(){return Array.prototype.slice.call(this.el.querySelectorAll(".chrome-tab"))}},{key:"tabContentEl",get:function(){return this.el.querySelector(".chrome-tabs-content")}},{key:"tabContentWidths",get:function(){for(var t=this.tabEls.length,e=this.tabContentEl.clientWidth,i=1*(t-1),n=(e-18+i)/t,a=Math.max(24,Math.min(240,n)),r=Math.floor(a),s=[],o=e-(r*t+18-i),l=0;l<t;l+=1){var c=r<240&&o>0?1:0;s.push(r+c),o>0&&(o-=1)}return s}},{key:"tabContentPositions",get:function(){var t=[],e=this.tabContentWidths,i=9;return e.forEach(function(e,n){var a=1*n;t.push(i-a),i+=e}),t}},{key:"tabPositions",get:function(){var t=[];return this.tabContentPositions.forEach(function(e){t.push(e-9)}),t}},{key:"activeTabEl",get:function(){return this.el.querySelector(".chrome-tab[active]")}}]),e}()});